# Banxway Backend - Environment Variables
# Phase 1: Unified Communication Integration Complete

# ============================================
# Server Configuration
# ============================================
NODE_ENV=development
PORT=8000
WS_PORT=8002
CORS_ORIGIN=http://localhost:3003

# ============================================
# Database - Supabase PostgreSQL
# ============================================
SUPABASE_URL=https://xxx.supabase.co
SUPABASE_ANON_KEY=eyJxxx...
SUPABASE_SERVICE_ROLE_KEY=eyJxxx...
DATABASE_URL=postgresql://postgres:postgres123@localhost:5432/banxway

# ============================================
# Redis - For BullMQ and Caching
# ============================================
REDIS_URL=redis://localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# ============================================
# Exotel - Voice, SMS, WhatsApp
# ============================================
EXOTEL_SID=your-exotel-sid
EXOTEL_TOKEN=your-exotel-token
EXOTEL_API_KEY=your-api-key

# Phone Numbers (NEW - Phase 1)
EXOTEL_PHONE_NUMBER=+1234567890
EXOTEL_SMS_NUMBER=+1234567890
EXOTEL_WHATSAPP_NUMBER=+1234567890

# API Configuration
EXOTEL_API_URL=https://api.exotel.com
EXOTEL_WEBHOOK_BASE_URL=http://localhost:8000

# ============================================
# Email - SMTP Configuration (Sending) - UPDATED Phase 1
# ============================================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-specific-password
SMTP_FROM_NAME=Banxway Support

# ============================================
# Email - IMAP Configuration (Receiving)
# ============================================
IMAP_HOST=imap.gmail.com
IMAP_PORT=993
IMAP_USER=your-email@gmail.com
IMAP_PASS=your-app-specific-password
IMAP_TLS=true
EMAIL_POLL_INTERVAL=30000

# ============================================
# Transcription Services (NEW - Phase 1)
# ============================================
# Primary: OpenAI Whisper (Recommended)
OPENAI_API_KEY=sk-your-openai-api-key
TRANSCRIPTION_PROVIDER=openai

# Alternative: OpenRouter
OPENROUTER_API_KEY=sk-or-v1-your-openrouter-key

# Alternative: AssemblyAI
# ASSEMBLYAI_API_KEY=your-assemblyai-key
# TRANSCRIPTION_PROVIDER=assemblyai

# ============================================
# AI Services
# ============================================
OPENAI_API_KEY=sk-xxx
ANTHROPIC_API_KEY=sk-ant-xxx
HUGGINGFACE_API_KEY=your-huggingface-key
ELEVENLABS_API_KEY=your-elevenlabs-key
AI_MODEL=gpt-4-turbo-preview
AI_MAX_TOKENS=2000

# ============================================
# AgentBuilder MCP (Phase 2)
# ============================================
MCP_API_URL=https://agentbuilder.example.com
MCP_API_TOKEN=xxx
MCP_WEBSOCKET_URL=wss://agentbuilder.example.com/ws

# ============================================
# Security
# ============================================
JWT_SECRET=your-secret-key
JWT_EXPIRES_IN=7d

# ============================================
# Rate Limiting
# ============================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
# Higher limit for polling endpoints (presence, notifications)
# Calculation: ~67.5 req/user/15min (notifications:30, online:30, heartbeat:7.5)
# Default 300 allows ~4 concurrent users or multiple browser tabs
POLLING_RATE_LIMIT_MAX=300

# ============================================
# File Upload
# ============================================
MAX_FILE_SIZE=10485760
ALLOWED_FILE_TYPES=pdf,doc,docx,xls,xlsx,jpg,jpeg,png

# ============================================
# Logging
# ============================================
LOG_LEVEL=info

# ============================================
# Phase 1 Setup Notes
# ============================================
#
# 1. Gmail App-Specific Passwords:
#    - Enable 2FA on your Gmail account
#    - Generate app-specific password: https://myaccount.google.com/apppasswords
#    - Use for both SMTP_PASS and IMAP_PASS
#
# 2. Exotel Configuration:
#    - Get credentials from Exotel Dashboard
#    - Add phone numbers for Voice, SMS, WhatsApp
#    - Configure webhooks in Exotel Dashboard
#    - For local testing, use test webhook endpoints (no ngrok needed)
#
# 3. OpenAI API Key:
#    - Get from: https://platform.openai.com/api-keys
#    - Required for call transcription (Whisper model)
#    - Costs: ~$0.006 per minute of audio
#
# 4. Redis Setup:
#    - Required for transcription job queue (BullMQ)
#    - Docker: docker run -d -p 6379:6379 redis
#    - Or use managed Redis (Upstash, Redis Cloud, etc.)
#
# 5. Database Migration:
#    - Run: database/migrations/002_add_sms_and_transcription.sql
#    - Adds: transcription_status, transcription_language, transcription_confidence
#    - Adds: SMS channel support and indexes
#
# 6. Test Endpoints (Development Only):
#    - Automatically enabled when NODE_ENV != production
#    - Access at: http://localhost:8000/api/v1/test/webhooks
#    - No ngrok needed for local webhook testing
#
# 7. Transcription Worker:
#    - Ensure Redis is running
#    - Worker starts automatically with backend
#    - Processes up to 5 transcriptions concurrently
#    - Monitor at: http://localhost:8000/api/v1/workers/status (if implemented)
